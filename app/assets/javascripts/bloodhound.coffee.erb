ready_bloodhound = ->
    community_names = new Bloodhound {
      datumTokenizer: Bloodhound.tokenizers.obj.whitespace('name'),
      queryTokenizer: Bloodhound.tokenizers.whitespace,
      local: [
        <% Community.all.each do |community| %>
        { name: "<%= community.name %>" },
        <% end %>
      ]
    }

    community_names.initialize();

    $('#communities').typeahead {
        minLength: 1,
        highlight: true,
    }, {
        displayKey: 'name',
        source: community_names.ttAdapter()
    }


# Fire the ready function on load and refresh.
$(document).ready(ready_bloodhound)
$(document).on('page:load', ready_bloodhound)