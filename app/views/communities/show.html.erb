<div class="row">

  <div class="large-8 columns">
    <div class="row">
      <div class="large-9 columns">
        <h2 class="title">
          <%= @community.name %>
        </h2>
      </div>
      <div class="large-3 columns">
        <% if current_user == @creator %>
            <%= link_to edit_community_path(@community), class: 'button tiny icon', title: 'Edit Community' do %>
                <% image_tag 'edit-icon.svg', class: 'icon' %>
            <% end %>
        <% end %>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns">
        <% if @community.image %>
            <%= image_tag @community.image.url, class: 'community-image',
                          style: 'border: 5px solid ' + @community.color %>
        <% end %>
        <br/><br/>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns">
        <%= @community.description %>
        <br/><br/>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns social">
        <% unless @community.home_page.blank? %>
            <%= link_to @community.home_page, target: '_blank' do %>
                <%= image_tag 'globe-icon.svg', class: 'icon' %>
            <% end %>
        <% end %>
        <% unless @community.facebook_link.blank? %>
            <%= link_to @community.facebook_link, target: '_blank' do %>
                <% image_tag 'facebook-icon.svg', class: 'image-link' %>
            <% end %>
        <% end %>
        <% unless @community.twitter_link.blank? %>
            <%= link_to @community.twitter_link, target: '_blank' do %>
                <% image_tag 'twitter-icon.svg', class: 'image-link' %>
            <% end %>
        <% end %>
        <% unless @community.google_link.blank? %>
            <%= link_to @community.google_link, target: '_blank' do %>
                <% image_tag 'google-icon.svg', class: 'image-link' %>
            <% end %>
        <% end %>
        <br/><hr/><br/>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns">
        <% if current_user && !@community.users.include?(current_user) %>
            <%= form_tag("/communities/#{@community.id}/users", method: 'patch', class: 'join-community') do |f| %>
                <%= hidden_field_tag 'user_id', current_user.id %>
                <%= button_tag type: 'submit', class: 'button small' do %>
                    <%= image_tag 'group-icon.svg', class: 'ty-icon' %>
                    &nbsp;
                    Join <%= @community.name %>
                <% end %>
            <% end %>
            &nbsp;&nbsp;
        <% end %>

        <% if current_user %>
            <% if current_user.subscriptions.find_by(community_id: @community.id) %>
                <%= link_to '#',
                            class: 'button secondary small community-subscribe',
                            title: 'Unsubscribe from Community',
                            data: { community_id: @community.id, current_user_id: current_user.id,
                                    status: 'subscribed' } do %>

                    <%= image_tag 'tack-icon-green.svg', class: 'ty-icon' %>
                    &nbsp;
                    Unsubscribe
                <% end %>
                &nbsp;&nbsp;
            <% else %>
                <%= link_to '#',
                            class: 'button small community-subscribe',
                            title: 'Subscribe to Community',
                            data: { community_id: @community.id, current_user_id: current_user.id,
                                    status: 'unsubscribed' } do %>
                    <%= image_tag 'tack-icon.svg', class: 'ty-icon' %>
                    &nbsp;
                    Subscribe
                <% end %>
                &nbsp;&nbsp;
            <% end %>
        <% end %>

        <%= link_to new_post_path(community: @community.name), class: 'button small' do %>
            <%= image_tag 'plus-icon.svg', class: 'ty-icon' %>
            &nbsp;
            New Post
        <% end %>
        <br/><br/>
      </div>
    </div>

    <div class="row">
      <div class="large-12 columns">
        <ul class="tabs" data-tab>
          <li class="tab-title active"><a href="#posts">Posts</a></li>
          <li class="tab-title"><a href="#members">Members</a></li>
        </ul>

        <div class="tabs-content">
          <div class="content active" id="posts">
            <ul class="no-disc posts">
              <% @community.posts.reverse_each do |post| %>
                  <%= render 'layouts/posts_list', post: post %>
              <% end %>

              <% if @community.posts.blank? %>
                  <span class="grey">Currently there are no posts.</span>
              <% end %>
            </ul>
          </div>
          <div class="content" id="members">
            <ul class="no-disc member-list">
              <% @community.users.each do |user| %>
                  <li>
                    <% if user.photo %>
                        <%= link_to user do %>
                            <%= image_tag user.photo.thumb('75x75#').url %>
                        <% end %>
                        &nbsp;&nbsp;
                    <% end %>
                    <%= link_to "#{user.first_name} #{user.last_name}", user %>
                  </li>
              <% end %>

              <% if @community.users.blank? %>
                <span class="grey">Currently there are no members.</span>
              <% end %>
            </ul>
          </div>
        </div>

      </div>
    </div>

  </div>
</div>


<br/>
<br/>